# 组合数学复习提纲

SYSU Ziyue Fan 2020.11.03

## Chapter1 计数的基本原则

#### 加法原则

若$A_1,A_2,\cdots ,A_n$是互不相交的有穷集，则$|A_1\cup A_2\cup \cdots \cup A_n|=|A_1|+|A_2|+\cdots + |A_n|$。

## Chapter2 排列与组合

#### 一、排列

$$
P(n,r)=A^r_n=n(n-1)(n-2)\cdots (n-r+1)=\frac{n!}{(n-r)!}
$$

#### 二、组合

$$
C(n,r)=\mathrm{C}_n^r=\binom{n}{r}=\frac{n!}{r!(n-r)!}=\frac{A^r_n}{r!}=\binom{n}{n-r}
$$

#### 三、二项式定理

$$
(x+y)^n=\sum_{i=1}^n {\binom{n}{i}x^{(n-i)}y^i}\\=\binom{n}{0}x^n+\binom{n}{1}x^{n-1}y^1+\binom{n}{2}x^{n-2}y^2+\cdots+\binom{n}{n}y^n
$$

其中，$\dbinom{n}{i}$为二项式系数。

#### 四、组合数恒等式

1. $\sum_{k=0}^n {\dbinom{n}{k}}=2^k$
   - 令$x=y=1$，则$(x+y)^n=2^n$，再运用二项式定理即证。
2. $\sum_{k=0}^n {(-1)^k\dbinom{n}{k}}=0$
   - 令$x=y=$0，则$(x+y)^n=0$，再运用二项式定理即证。
3. $\sum_{k=0}^n {2^k\dbinom{n}{k}}=3^k$
   - 令$x=1,y=2$，则$(x+y)^n=3^n$，再运用二项式定理即证。
4. $\sum_{k=1}^n {k\dbinom{n}{k}}=n\cdot2^{n-1}$
   - 令$x=1$，再在两边==对$y$求导==，注意此时$k=0$项为不含$y$的常数项，因此在求导时被消为0，故在等式中$k$从1开始。之后再令$y=1$即证。

5. （Pascal等式）$\dbinom{n+1}{k}=\dbinom{n}{k}+\dbinom{n}{k-1}$
   - 利用组合证明：令集合$|S|=n+1$，在$S$中直接选$k$个元素，即$\dbinom{n+1}{k}$。或将集合任意分为大小为$n$和$1$的两份，在大小为$n$的集合中选取$k$个元素即$\dbinom{n}{k}$；或在大小为$n$的集合中先选$k-1$个，再选取大小为$1$的集合中的元素，即$\dbinom{n}{k-1}$。
   - 常用该定理进行组合数相加形式的化简。
6. （Vandermonde等式）$\dbinom{m+n}{r}=\dbinom{m}{r-k}+\dbinom{n}{k}$

#### 五、在$n$种元素中取$r$个允许重复的组合

从$n$个元素的集合中取允许重复的$r$组合的方案数为
$$
\dbinom{n+r-1}{r}=\dbinom{n+r-1}{n-1}
$$

- 实际上，假设有$7$种钱币（无限数量），从这些钱币中拿出$5$个，则==相当于拿出$6$个（$6=7-1$）隔板==和$5$个球进行排列。由于隔板和球不可区分，因此先在这$11$个空位中选$5$个位置填球，剩下的空位就自动填为隔板了，故最后的方案数为$\binom{6+5-1}{5}$种。
- 更一般地，有$n$个变量（$x_1,x_2,\cdots,x_n$），这些变量的和为$r$，限定$\forall i,x_i \geqslant 0$（相当于在钱币中可以取$0$个），则最后解的数量为$\binom{n+r-1}{r}$个。

#### 六、$k$种不可区别的元素排列

对$k$种元素，分别有$n_k$个不可区别的对象，总计$n$个元素（$\sum_{i=1}^k{n_i}=n$）。这些元素在一起的排列方案总数为
$$
\dbinom{n}{n_1} \cdot \dbinom{n-n_1}{n_2} \cdots \dbinom{n-n_1-\cdots-n_{k-1}}{n_k}=\frac{n!}{n_1!n_2!\cdots n_k!}
$$

- 利用具体数值摆开组合数公式，将会很容易看出来化简过程。

#### 七、将小球放入盒子中的模型

1. 将可区别的小球放入可区别的盒子中（需要指定盒子中放几个小球），同6理。
2. 将不可区别的小球放入可区别的盒子中（允许有空盒），同5理。
3. 其余情况太过复杂，在此处不作讨论。

## Chapter3 容斥原理与鸽笼原理

#### 一、容斥原理

1. 两个集合的并的容斥原理
   $$
   |A\cup B|=|A|+|B|-|A\cap B|
   $$

2. 三个集合的并的容斥原理
   $$
   |A\cup B\cup C|=|A|+|B|+|C|-|A\cap B|-|A\cap C|-|B\cap C|+|A\cap B\cap C|
   $$

3. 有否定形式的容斥原理

   首先由De Morgan律，有
   $$
   \overline{A\cap B} = \overline{A}\cup \overline{B}\\\overline{A\cup B} = \overline{A}\cap \overline{B}
   $$
   因此有（以三个集合为例）
   $$
   |\overline{A_1}\cap \overline{A_2}\cap \overline{A_3}|=|\overline{A_1\cup A_2\cup A_3}|=N-|A_1\cup A_2\cup A_3|
   $$
   再使用三个集合的并的容斥原理即可。

#### 二、利用容斥原理求方程组非负整数解的数目（一般为$\geqslant$）

1. 未知数的解有下界

   先换元，令$y_i=x_i-k$，即由$x_i\geqslant k$变换到$y_i\geqslant 0$，对等式右边的和进行相应修改（==千万不要弄错加减==），再利用§2.5的知识求解。

2. 未知数的解有上界

   设$P_i: x_i\geqslant k$，则有$\overline{P_i}:x_i<k$。利用容斥原理，即$N(\overline{P_1} \overline{P_2} \overline{P_3})=N-N(P_1\cup P_2\cup P_3)=\cdots$，再通过1中方法算$N(P_1\cup P_2\cup P_3)$。

3. 未知数的解有上界和下界

   先换元，令$y_i=x_i-k$，即由$k\leqslant x_i\leqslant k'$变换到$0\leqslant x_i\leqslant k'-k$上，再通过结合1和2的方法完成求解。注意到若存在$x_i \ge m$，则就先在右侧减去$m$，再在剩下的按1的后面部分求解。

#### 三、利用容斥原理求（不）被整除的整数个数

1. 若题设要求在$1\sim M$中被$k$整除的个数，则令
   $$
   N=\lfloor \frac{M}{k} \rfloor
   $$

2. 若题设要求在$1\sim M$中被$a,b$同时整除的个数，则令
   $$
   N=\lfloor \frac{M}{[a,b]} \rfloor
   $$
   其中$[a,b]$为$a$和$b$的==最小公倍数==。

#### 四、鸽笼原理的应用

> 鸽笼原理的加强形式：设$A$是有限集，$q_1,q_2,\dots ,q_n$都是正整数。若$|A|\ge q_1+q_2+\dots +q_n-n+1,A_i\subseteq A,(i=1,2,\dots,n)$且$\bigcup_{i=1}^{n}A_i=A$，则必存在正整数$k(1\ge k\ge n)$，使得$|A_k|\ge q_k$。

- 举例说明

**倍数问题：**将一堆球（数量大于10）放入10个盒子里，每个盒子至少放一个。求证：必有若干个盒子，其中球的数量之和为10的倍数。

**证明：**

​		设第$i(i=1,2,\dots,10)$个盒子中有$x_i$个球。令$A={a_1,a_2,\dots,a_{10}}$，且有$a_j=x_1+x_2+\dots+x_j,(j=1,2,\dots,10)$。

​		对任意一个整数$j,(0\le j\le 9)$，令$A_j=\{a|a\in A且a除以10余数为j\}$，则有$A_j\subseteq A$，且$\bigcup_{j=0}^{9}A_j=A$。

​		1) 若$A_0 \ne \varnothing$，则显然存在。

​		2) ==若$A_0 = \varnothing$，则$\bigcup_{j=1}^{9}A_j=A$，由鸽笼原理，必$\exist t \in [1,9]$使得$|A_t|\ge 2$。==之后证明略（通过将两者相减，得出的$x_i$之和即为所求）。

**差数问题：**37个盒子排成一排，将60个球放入盒子中，每个盒子至少放一个。求证：必存在若干个连续的盒子，其中球的数量之和恰为13个。

**证明：**

​		设从第$1$个盒子到第$i(i=1,2,\dots,37)$个盒子共有$a_i$个球。则有
$$
1\le a_1<a_2<\cdots<a_{37}=60
$$
​		==令$b_i=a_i+13(i\le i\le 37)$==，则有
$$
14\le b_1<b_2<\cdots<b_{37}=73
$$
​		令$A={1,2,\dots,73},A_1={a_1,a_2,\dots,a_{37}},A_2={b_1,b_2,\dots,b_{37}}$，则$A_1\cup A_2 \subseteq A$。

​		==若$A_1\cap A_2=\varnothing$，则$|A|\ge |A_1|+|A_2|=74$，这与$|A|=73$矛盾，因此$A_1\cap A_2 \ne \varnothing$。==

​		从而存在$a_k\in A_1,b_l\in A_2$，使得$a_k=b_l$，即$a_k=a_l+13 \Rightarrow a_k-a_l=13$，得证。

## Chapter4 母函数

#### 一、母函数$G(x)$与原数列$\{a_n\}$的对应关系

1. 由$\frac{1}{1-x}=1+x+x^2+x^3+\cdots$，可知
   $$
   \frac{1}{1-x} \Rightarrow \{1,1,1,\cdots\} \Rightarrow \boxed{a_n=1}
   $$

2. 由$\frac{1}{1-kx}=1+kx+k^2x^2+k^3x^3+\cdots$，可知
   $$
   \frac{1}{1-kx} \Rightarrow \{1,k,k^2,\cdots\}\Rightarrow \boxed{a_n=k^n}
   $$

3. 由$\frac{1}{(1-x)^2}=1+2x+3x^2+4x^3+\cdots$，可知
   $$
   \frac{1}{(1-x)^2} \Rightarrow \{1,2,3,\cdots\}\Rightarrow \boxed{a_n=n}
   $$

4. 由$\frac{1}{(1-x)^n}=\binom{n-1}{0}+\binom{1+n-1}{1}x+\binom{2+n-1}{2}x^2+\binom{3+n-1}{3}x^3+\cdots$，可知
   $$
   \frac{1}{(1-x)^n} \Rightarrow \{\binom{n-1}{0},\binom{1+n-1}{1},\binom{2+n-1}{2},\cdots,\binom{r+n-1}{r},\cdots\}\Rightarrow \boxed{a_n=\binom{n+r-1}{n}}
   $$

#### 二、整数的拆分与多项式的设法

权重代表多项式中$x$最低次的次数（$\ge 1$），个数代表多项式中$x^i$的个数。

**例：**有1g的砝码3枚，2g的砝码4枚，4g的砝码2枚，求组合成15g的方案数。

​		显然依次对应多项式：$(1+x+x^2+x^3),(1+x^2+x^4+x^6+x^8),(1+x^4+x^8)$，再将三个式子相乘计算$x^{15}$项的系数即可。

> 注意到在计算相乘的过程中，若取到因子$1$则代表不取该类砝码，取到因子$x^{a}$则代表取$b$g的砝码$a/b$个。

#### 三、递推数列的构造方法

对于一般情况，通常是==找第$a_n$与$a_{n-1}$的关系==。因此，把第$n-1$种情况和第$n$种情况分别列出来，则可得递推关系式。

**例：**由A、B、C、D取$n$个做可重复的排列，要求其中A出现偶数次，求其分别的排列数$a_n$。

​		先令当取$n-1$个时，A出现偶数次的排列数为$a_{n-1}$；

​		则当取$n$个时，A出现偶数次的排列数为：

​		1) 前$n-1$个数中A出现了偶数次，则第$n$位必不为A，此时有$3a_n$；

​		2) 前$n-1$个数中A出现了奇数次，则第$n$位必为A，此时有$1\times (4^n-a_n)$。

​		因此得到递推关系式：$a_{n}=2a_n+4^n$。之后列出首项，通过母函数求解（注意因式分解分式的方法：分解成$\frac{A}{f(x)}+\frac{B}{g(x)}+\cdots$的形式）。

- 尤为注意最后分解分式的方法。例如分母为$(1-2x)(1-x)^2$，则==必须要设出一次方分母项==，即设
  $$
  \frac{A}{1-2x}+\frac{B}{1-x}+\frac{C}{(1-x)^2}
  $$
  最后根据对应次数前的系数相等求出$A,B,C$。

#### 四、母函数的应用

- 求具体的组合方案

  对于不同种类的元素，各给定一个变量，根据各自具体数量列出相应多项式。所得结果中，各变量的次数为该方案中各个元素取出的个数。

  **例：**设红球、白球、黄球数量分别为2、1、1，列出所有的组合方案。

  ​		显然，设分别为$x,y,z$，对应的多项式则分别为$(1+x+x^2),(1+y),(1+z)$。之后相乘即可。

- 求组合方案的总和

  类似于上一类题目，但是==均设为$x$==，将所有项系数相加即可求解。

注意到这里变量的次数同样和所取数量有关，可以根据题目要求保留特定次数的项。

#### 五、错排问题

- 错排的递推公式为
  $$
  D_n=(n-1)(D_{n-1}+D_{n-2})
  $$

- 错排的公式为
  $$
  D_n=n!(1-\frac{1}{1!}+\frac{1}{2!}+\frac{1}{3!}+\cdots +(-1)^n\frac{1}{n!})\approx n!e^{-1}
  $$

#### 六、线性常系数递推关系式

- 适用于该方法的递推关系式必须为线性的，即不含常数项的线性组合。若不满足，可通过==列出第$n+2,n+1,n$项多次相减进行常数项消去==（消去$n,C(C\in R)$）。递推关系式形式如下：

$$
a_n=c_1a_{n-1}+c_2a_{n-2}+\cdots+c_ka_{n-k}
$$

- 解题过程

  1. 先将递推关系式转化为线性的（如上）。

  2. 写出特征方程。由最低次到最高次从$x$的$0$次幂（即$1$）开始排。如$a_n=3a_{n-2}-2a_{n-3} \Rightarrow x^3-3x+2=0$。

     解这个方程后，设多个参数$c_1,c_2,\dots$，设$x_i$为特征方程的$k_i$重根，则列出通项公式
     $$
     a_n=\sum(c_{i1}+c_{i2}n+\cdots+c_{ik_i}n^{k_i-1})x_i^n
     $$
     又如上面的$x^3-3x+2=0$可以因式分解为$(x+2)(x-1)^2$，则列出通项公式$a_n=(c_1+c_2n)1^n+c_3(-2)^n$。

     代入初始条件（通常为前几项），列出方程组即可求出通项。

- 若用母函数的方式求递推关系式，则要先令
  $$
  G(x)=a_0+a_1x+a_2x^2+\cdots
  $$
  写出首项，依次摆开竖式相加求解$G(x)$，最后再分解分式。

## Chapter5 Pólya计数法

#### 一、群需要满足的四个条件

给定一个集合$G={a,b,c,\cdots}$和集合$G$上的二元运算“$\cdot$”。

1. 封闭性：任意两个集合中元素的运算结果还是在集合中。
   $$
   \forall a,b\in G, \exist c\in G, s.t. a\cdot b=c
   $$

2. 结合律成立
   $$
   \forall a,b,c\in G, (a\cdot b)\cdot c = a\cdot (b\cdot c)
   $$

3. 存在单位元
   $$
   \exist e\in G, s.t.\forall a\in G, e\cdot a=a\cdot e=a
   $$

4. 存在逆元
   $$
   \forall a\in G, \exist b\in G, s.t.a\cdot b=b\cdot a=e
   $$
   此时记作$b=a^{-1}$

#### 二、奇置换与偶置换

- 若一个置换可以分解为奇数个对换之积，则叫做奇置换；反之则成为偶置换。

- $n$个文字的对称群$S_n$中偶置换的全体构成一个大小为$\frac{1}{2}n!$的子群记作$A_n$，称为交代群；反之记作$B_n$。这两者大小均为$\frac{1}{2}n!$，他们的关系为
  $$
  |A_n|+|B_n|=n!
  $$

#### 三、置换分解的格式与共轭类

- 针对置换中每个循环阶数对应出现的次数，置换可以相应格式。例如
  $$
  (1)(23)(4567)\Rightarrow(1)^1(2)^1(3)^0(4)^1(5)^0(6)^0(7)^0(8)^0
  $$

- 在$S_n$中具有==相同格式==的置换全体，叫做与该格式相应的共轭类。

  对于$S_n$中属于$(1)^{c_1}(2)^{c_2}\cdots (n)^{c_n}$的共轭类元素个数为
  $$
  \frac{n!}{c_1!c_2!\cdots c_n!1^{c_1}2^{c_2}\cdots n^{c_n}}
  $$
  例如在$S_4$中，$(1)^0(2)^2(3)^0(4)^0$的共轭类共有$\frac{4!}{2!2^2}=3$个置换，即$(12)(34),(13)(24),(14)(23)$。

#### 四、$k$不动置换类

设$G$是$1,2,\dots,n$的置换群，$k$是$1$到$n$中的一个整数，则$G$中使$k$保持不变的置换全体记作$Z_k$，叫做$G$中的$k$不动置换类。

- 实际上，==$Z_k$是$G$中有因子$(k)$的置换的全体==。

#### 五、等价类

设$G$是$1,2,\dots,n$的置换群，$k$是$1$到$n$中的一个整数，若存在置换$p_1$使$k$变为$l$，则称$k$和$l$属于同一个等价类，数$k$所属的等价类记为$E_k$。

- 注意到$k$不动置换类和数$k$所属的等价类都是相对于特定置换群$G$而言。
- 注意到运算符“$\dotplus$”代表不相交集合的并

存在如下定理：
$$
|E_k||Z_k|=|G|, k=1,2,\dots,n
$$

#### 六、利用Pólya定理求着色问题等价类的个数

1. 首先对$n$个对象进行编号为$1,2,\dots,n$，确定置换群的单位元为$(1)(2)\cdots (n)$，且有$k$种颜色用于着色。

2. 根据对象的各种等价类变换，写出相应的置换群$G$。

   - 通常对于各种平面图形沿对称轴旋转；对于空间图形要考虑到空间中的旋转、翻转。

3. 最后所得方案数为
   $$
   m=\frac{1}{|G|}(k^{c_1}+k^{c_2}+\cdots +k^{c_{|G|}})
   $$
   其中，$c_i$代表置换群$G$中置换$p_i$的循环节数，如存在置换$p=(23)(1)(4)$（有多少对括号就有多少个循环节），则后面的括号中要加上一项$k^3$。

#### 七、利用Pólya定理和母函数求着色问题具体某个方案的个数

从特殊的情况开始研究。若存在3种颜色，4个格子，则可令变量$x,y,z$。由§5.6中可知，总的方案数为$m=\frac{1}{|G|}(k^{c_1}+k^{c_2}+\cdots +k^{c_{|G|}})$，将之后的括号中内容改写。具体规则如下：

- 对于形如$(1)(2)(3)(4)$的，在总方案数中表示的一项为$k^4$（因为有4个循环节），在此处记为$(x+y+z)^4$。
- 对于形如$(1234)$的，在总方案数中表示的一项为$k^1$，在此处记为$(x^4+y^4+z^4)$。
- 对于形如$(12)(34)$的，在总方案中表示的一项为$k^2$，在此处记为$(x^2+y^2+z^2)^2$。
- 对于形如$(1)(2)(34)$的，在总方案中表示的一项为$k^3$，在此处记为$(x+y+z)^2(x^2+y^2+z^2)$。

之后得出的结果中，如$4x^2yz$表示选取2个颜色$x$，1个颜色$y$，1个颜色$z$的方案数有4种。

下面是一般的情况。总着色数为$n$，分别表示为变量$x_1,x_2,\dots,x_n$。对于置换群$G$中的一个置换$p$，若其能表示为
$$
(1)^{c_1}(2)^{c_2}\cdots (n)^{c_n}
$$
则在总方案中表示的一项为$k^{\sum_{i=1}^{n}c_i}$，在此处记为
$$
\prod_{i=1}^n (x^i_1+x^i_2+\cdots+x^i_n)^{c_i}
$$





$$
-END-
$$
